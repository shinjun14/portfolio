<div class="container">
  <div class="row">
    <div class="col">
      <%= render "layouts/sidebar" %>
    </div>

    <div class="col-md-7 mt-1">
      <h1 class="text-center">投稿してみよう！</h1>
      <%= form_with model: @hobby, url:hobbies_path, local:true do |f| %>
        <%= f.hidden_field :category, :value => "games" %>
        <div class="text-center">
          <%= f.text_field :title, placeholder:"一言", class:"bg-transparent"%>
          <%= f.text_field :name, placeholder:"ゲーム名", class:"bg-transparent" %>
        </div>
        <div class="text-center m-3">
          <%= f.text_field :good_part, placeholder:"良い点", class:"bg-transparent" %>
          <%= f.text_field :bad_part, placeholder:"悪い点", class:"bg-transparent"%>
        </div>
        <div class="text-center" id="rate_stars">
          <label>評価</label>
        </div>
        <div class="text-center m-3">
          <%= f.attachment_field :image %>
        </div>
        <div class="text-center">
          <%= f.text_area :introduction, placeholder:"本文", size: "40x5", class:"bg-transparent" %>
        </div>
        <div class="text-center mb-5">
          <input type="submit" name"commit" value="投稿" class="btn btn-primary" data-disable="Create Hobby" />
        </div>
      <% end %>
      <script>
        $('#rate_stars').raty({
          starOn: "<%= asset_path('star-on.png') %>",
          starOff: "<%= asset_path('star-off.png') %>",
          starHalf: "<%= asset_path('star-half.png') %>",
          scoreName: 'hobby[rate]'
        });
      </script>

      <% @hobbies.each do |hobby| %>
        <div class="mb-5">
          <div class="ml-5">
            <%= link_to user_path(hobby.user.id) do %>
              <%= attachment_image_tag hobby.user, :profile_image, size: "50x50", fallback: "user-gf1c075314_1280.png", class:"rounded-circle" %>
            <% end %>
            <strong><%= hobby.user.name %></strong><br>
          </div>
          <div class="text-center mb-2">
            <strong><%= link_to hobby.title, hobby_path(hobby.id), class:"text-dark" %></strong>
            (<%= hobby.name %>)
            <%= link_to "コメント#{hobby.comments.count}件", hobby_path(hobby.id), class:"text-dark" %> <!--コメント数 -->
            <% if hobby.user == current_user || current_user.admin? %> <!--削除機能 -->
              <%= link_to "削除", hobby_path(hobby), method: :delete, class:"btn btn-danger" %>
            <% end %>
          </div>

          <div>
            <p id="hobby-rate-<%=hobby.id %>"></p>
          </div>

          <div class="text-center">
            <%= attachment_image_tag hobby, :image, format: 'jpg', size: "350x300" %>
          </div>
        </div>
             <script>

        $('#hobby-rate-<%= hobby.id %>').raty({
          size: 36,

          half: true,
          readOnly: true,
          score: "<%= hobby.rate %>",
          path: '/assets/'
          //注目ポイント↑ 平均点を算出し、round関数で切り上げ
        });
      </script>
      <% end %>

    </div>

    <div class="col">
      <h1>おすすめ</h1>
    </div>
  </div>
</div>